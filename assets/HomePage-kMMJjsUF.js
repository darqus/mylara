import{d as q,r as h,a as K,y as x,f as l,s as a,K as b,p as i,q as p,L as E,O as Y,F as T,R as Z,v as $,S as G,T as w,B as N,U as J,C as Q,V as P,c as ee,e as k,x as d,z as O,t as te,D,A as ae,W as se,X as oe,Y as le,Z as R,$ as re,a0 as ne,a1 as ie,a2 as ce,u as ue,a3 as de}from"./vendor-BWNmmB4S.js";import{S as me,a as ve}from"./seo-constants-CrgudmTl.js";import{firestoreService as A}from"./firestore.service-Bwc5dqkm.js";import"./index-WC_OeSB9.js";import"./firebase-vendor-CJeZ2BEb.js";const pe={key:0},ge={key:0,class:"q-my-md"},fe={key:0},he={class:"text-h6 q-mt-md text-secondary"},M=q({__name:"DataLoader",props:{error:{type:Boolean,default:!1},isEmpty:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},emptyText:{default:"Нет доступных данных"},errorText:{default:"Произошла ошибка при загрузке данных"},loadingText:{default:""},fetchData:{type:Function,default:()=>Promise.resolve({})},dataKey:{default:""}},emits:["retry","data-loaded"],setup(r,{emit:c}){const n=r,_=c,u=h(!1),g=h(""),t=h(null),s=async()=>{u.value=!0,g.value="";try{const e=await n.fetchData();t.value=n.dataKey!==""&&typeof e=="object"&&e!==null?e[n.dataKey]:e,_("data-loaded",t.value)}catch(e){g.value=e instanceof Error?e.message:"Произошла ошибка при загрузке данных"}finally{u.value=!1}},m=()=>{s(),_("retry")};return K(()=>{s()}),(e,S)=>(l(),x(T,null,[a(Y,{showing:e.loading||u.value},{default:i(()=>[p("div",null,[E(e.$slots,"loading",{},()=>[a(Z,{color:"primary",size:"40px"}),e.loadingText?(l(),x("div",pe,$(e.$props.loadingText),1)):b("",!0)])])]),_:3},8,["showing"]),!(e.loading||u.value)&&(e.error||g.value)?(l(),x("div",ge,[E(e.$slots,"error",{},()=>[a(J,{class:"bg-negative text-white",rounded:""},{avatar:i(()=>[a(N,{name:"error"})]),action:i(()=>[a(w,{color:"white",label:"Попробовать снова",flat:"",onClick:m})]),default:i(()=>[G(" "+$(g.value||e.$props.errorText)+" ",1)]),_:1})])])):b("",!0),!(e.loading||u.value)&&!(e.error||g.value)?(l(),x(T,{key:1},[!e.$props.isEmpty&&(t.value||e.$slots.content)?E(e.$slots,"content",{key:0,data:t.value},()=>[t.value?(l(),x("div",fe,$(t.value),1)):b("",!0)]):E(e.$slots,"empty",{key:1},()=>[a(Q,{class:"q-pa-md"},{default:i(()=>[a(N,{color:"grey-6",name:"o_info",size:"4em"}),p("div",he,$(e.$props.emptyText),1),a(w,{class:"q-mt-md",color:"primary",label:"Обновить",outline:"",onClick:m})]),_:1})])],64)):b("",!0)],64))}}),ye=()=>{const r=P();return{isMobile:ee(()=>r.screen.lt.sm)}};function U(){const r=h(new Set),c=(t,s="/logo.svg")=>{const m=t.target,e=m.src;console.warn("Failed to load image:",e),r.value.add(e),m.src!==s&&(m.src=s,m.alt="Изображение недоступно",m.classList.add("fallback-image"))},n=t=>{const s=t.target;s.setAttribute("data-loaded","true"),s.classList.remove("fallback-image")},_=t=>r.value.has(t);return{failedImages:r,handleImageError:c,handleImageLoad:n,isImageFailed:_,getSafeImageSrc:(t,s="/logo.svg")=>_(t)?s:t,clearFailedImages:()=>{r.value.clear()}}}const _e=async()=>A.getCollection("carousel","Не удалось загрузить данные карусели"),be={class:"carousel-wrapper relative-position"},ke=["onTouchend"],xe=["src"],$e={class:"text-label text-subtitle2 q-mb-sm"},we={class:"btn-more"},Se={class:"text-body1"},Ce=["innerHTML"],Ie={class:"text-caption text-grey-6"},Te=q({__name:"LandingCarousel",setup(r){const{isMobile:c}=ye(),{handleImageError:n,handleImageLoad:_}=U(),u=h(0),g=h(!1),t=h(null),s=h(null),m=h(null),e=h(),S=h(),V=({id:v,img:f,label:o,link:y,info:C})=>{t.value={id:v,img:f,label:o,link:y,info:C},g.value=!0,m.value=v},B=v=>{u.value<v.length-1&&(u.value++,H())},F=()=>{u.value>0&&(u.value--,H())},H=()=>{const v=document.querySelector(".carousel-items-container"),o=document.querySelectorAll(".carousel-card-container")[u.value];if(v&&o){const y=o.clientWidth;v.scrollTo({left:y*u.value,behavior:"smooth"})}},W=v=>{e.value=v?.touches[0]?.clientX},j=(v,f)=>{if(v.changedTouches&&v.changedTouches.length>0){S.value=v?.changedTouches[0]?.clientX;const o=e.value-S.value;Math.abs(o)>50&&(o>0?B(f):F())}};return K(()=>{s.value&&s.value.addEventListener("touchstart",W,{passive:!0})}),(v,f)=>(l(),x(T,null,[a(M,{"fetch-data":d(_e),"data-key":"items"},{content:i(({data:o})=>[p("div",be,[d(c)?b("",!0):(l(),k(w,{key:0,disable:u.value===0,class:"carousel-nav-btn carousel-prev-btn",color:"primary",icon:"chevron_left",round:"",onClick:F},null,8,["disable"])),p("div",{ref_key:"carouselRef",ref:s,class:"carousel-items-container q-py-lg q-my-sm",onTouchend:y=>j(y,Array.isArray(o)?o:[])},[(l(!0),x(T,null,O(Array.isArray(o)?o:[],({id:y,img:C,label:L,link:X,info:z})=>(l(),x("div",{key:y,class:"carousel-card-container"},[a(Q,{class:R([[{active:m.value===y}],"cursor-pointer my-card carousel-item-card"]),onClick:I=>V({id:y,img:C,label:L,link:X,info:z})},{default:i(()=>[p("img",{src:C,style:{width:"100%","aspect-ratio":"3/4","object-fit":"cover"},onError:f[0]||(f[0]=(...I)=>d(n)&&d(n)(...I)),onLoad:f[1]||(f[1]=(...I)=>d(_)&&d(_)(...I))},null,40,xe),a(D,{class:"description-wrapper text-center q-pb-sm"},{default:i(()=>[p("div",$e,$(L),1),p("div",we,[a(w,{class:"more-details-btn",color:"primary","icon-right":"arrow_forward",label:"Подробнее",size:"sm","no-caps":"",outline:"",onClick:re(I=>V({id:y,img:C,label:L,link:X,info:z}),["stop"])},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["class","onClick"])]))),128))],40,ke),d(c)?b("",!0):(l(),k(w,{key:1,disable:u.value===(Array.isArray(o)?o.length:0)-1,class:"carousel-nav-btn carousel-next-btn",color:"primary",icon:"chevron_right",round:"",onClick:y=>B(Array.isArray(o)?o:[])},null,8,["disable","onClick"]))])]),_:1},8,["fetch-data"]),a(le,{modelValue:g.value,"onUpdate:modelValue":f[2]||(f[2]=o=>g.value=o),onHide:f[3]||(f[3]=o=>m.value=null)},{default:i(()=>[t.value?(l(),k(Q,{key:0,style:{width:"clamp(300px, 50vw, 600px)"}},{default:i(()=>[a(te,{src:t.value.img,fit:"cover",onError:d(n)},null,8,["src","onError"]),t.value.label?(l(),k(D,{key:0},{default:i(()=>[p("div",Se,$(t.value.label),1)]),_:1})):b("",!0),t.value.info?(l(),k(D,{key:1,class:"q-pt-none"},{default:i(()=>[p("div",{class:"text-body2 text-grey-7",innerHTML:t.value.info},null,8,Ce),a(ae,{class:"q-my-md"}),p("div",Ie," ID элемента: "+$(t.value.id),1)]),_:1})):b("",!0),a(se,{align:"between"},{default:i(()=>[t.value.link?(l(),k(w,{key:0,href:t.value.link,color:"primary",icon:"open_in_new",label:"Перейти",target:"_blank",outline:""},null,8,["href"])):b("",!0),oe(a(w,{color:"red-3","icon-right":"close",label:"Закрыть",outline:""},null,512),[[ne]])]),_:1})]),_:1})):b("",!0)]),_:1},8,["modelValue"])],64))}}),qe=async()=>{const r=await A.getCollection("slides","Не удалось загрузить данные слайдов");return{slides:r.items.map(n=>({...n,id:Number(n.id)})),error:r.error}},Ee={class:"absolute-bottom custom-caption"},Le={class:"text-h2"},De={class:"text-subtitle1"},Qe=q({__name:"LandingSlider",setup(r){const c=P(),n=h(1),{getSafeImageSrc:_}=U();return(u,g)=>(l(),k(M,{"fetch-data":d(qe),"data-key":"slides"},{content:i(({data:t})=>[a(ie,{modelValue:n.value,"onUpdate:modelValue":g[0]||(g[0]=s=>n.value=s),class:R([{"height-xs":d(c).screen.xs,"height-sm":d(c).screen.sm,"height-md":d(c).screen.md,"height-lg":d(c).screen.lg||d(c).screen.xl},"bg-white text-white"]),"transition-next":"slide-left","transition-prev":"slide-right",animated:"",arrows:"",autoplay:"",infinite:"",swipeable:""},{default:i(()=>[(l(!0),x(T,null,O(t||[],({id:s,img:m,title:e,subtitle:S})=>(l(),k(ce,{key:s,"img-src":d(_)(m),name:s},{default:i(()=>[p("div",Ee,[p("div",Le,$(e),1),p("div",De,$(S),1)])]),_:2},1032,["img-src","name"]))),128))]),_:2},1032,["modelValue","class"])]),_:1},8,["fetch-data"]))}}),Ae=async()=>{const r=await A.getDocument("slogan","1","Не удалось загрузить данные слогана");return{title:r.data?.title??"",error:r.error}},Me=q({__name:"LandingSlogan",setup(r){return(c,n)=>(l(),k(M,{"fetch-data":d(Ae),"is-empty":!1,"data-key":"title"},null,8,["fetch-data"]))}}),Ve={class:"q-mx-auto q-pt-xl q-px-md",style:{"max-width":"1200px"}},Ne=q({__name:"HomePage",setup(r){return ue(()=>me.setMeta(ve)),(c,n)=>(l(),k(de,null,{default:i(()=>[a(Qe),p("div",Ve,[a(Me)]),a(Te)]),_:1}))}});export{Ne as default};
