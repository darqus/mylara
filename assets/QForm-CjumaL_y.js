import{ao as A,c as F,g as w,ap as E,d as l,h as v,aq as V,r as N,am as D,an as I,D as M,C as Q,aJ as R,V as P,ab as O,af as j,aM as G}from"./index-Dv7iRb9i.js";import{b as J}from"./format-BvkBI9bc.js";import{o as K}from"./use-quasar-B7cg2p2u.js";const T={...A,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:e=>e>=0&&e<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},$=50,_=2*$,z=_*Math.PI,W=Math.round(z*1e3)/1e3,Y=F({name:"QCircularProgress",props:{...T,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(e,{slots:h}){const{proxy:{$q:m}}=w(),k=E(e),u=l(()=>{const t=(m.lang.rtl===!0?-1:1)*e.angle;return{transform:e.reverse!==(m.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-t}deg)`:`rotate3d(0, 0, 1, ${t-90}deg)`}}),i=l(()=>e.instantFeedback!==!0&&e.indeterminate!==!0?{transition:`stroke-dashoffset ${e.animationSpeed}ms ease 0s, stroke ${e.animationSpeed}ms ease`}:""),a=l(()=>_/(1-e.thickness/2)),x=l(()=>`${a.value/2} ${a.value/2} ${a.value} ${a.value}`),c=l(()=>J(e.value,e.min,e.max)),b=l(()=>e.max-e.min),d=l(()=>e.thickness/2*a.value),g=l(()=>{const t=(e.max-c.value)/b.value,o=e.rounded===!0&&c.value<e.max&&t<.25?d.value/2*(1-t/.25):0;return z*t+o});function y({thickness:t,offset:o,color:f,cls:S,rounded:C}){return v("circle",{class:"q-circular-progress__"+S+(f!==void 0?` text-${f}`:""),style:i.value,fill:"transparent",stroke:"currentColor","stroke-width":t,"stroke-dasharray":W,"stroke-dashoffset":o,"stroke-linecap":C,cx:a.value,cy:a.value,r:$})}return()=>{const t=[];e.centerColor!==void 0&&e.centerColor!=="transparent"&&t.push(v("circle",{class:`q-circular-progress__center text-${e.centerColor}`,fill:"currentColor",r:$-d.value/2,cx:a.value,cy:a.value})),e.trackColor!==void 0&&e.trackColor!=="transparent"&&t.push(y({cls:"track",thickness:d.value,offset:0,color:e.trackColor})),t.push(y({cls:"circle",thickness:d.value,offset:g.value,color:e.color,rounded:e.rounded===!0?"round":void 0}));const o=[v("svg",{class:"q-circular-progress__svg",style:u.value,viewBox:x.value,"aria-hidden":"true"},t)];return e.showValue===!0&&o.push(v("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:e.fontSize}},h.default!==void 0?h.default():[v("div",c.value)])),v("div",{class:`q-circular-progress q-circular-progress--${e.indeterminate===!0?"in":""}determinate`,style:k.value,role:"progressbar","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.indeterminate===!0?void 0:c.value},V(h.internal,o))}}}),Z=F({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:h,emit:m}){const k=w(),u=N(null);let i=0;const a=[];function x(t){const o=typeof t=="boolean"?t:e.noErrorFocus!==!0,f=++i,S=(r,n)=>{m(`validation${r===!0?"Success":"Error"}`,n)},C=r=>{const n=r.validate();return typeof n.then=="function"?n.then(s=>({valid:s,comp:r}),s=>({valid:!1,comp:r,err:s})):Promise.resolve({valid:n,comp:r})};return(e.greedy===!0?Promise.all(a.map(C)).then(r=>r.filter(n=>n.valid!==!0)):a.reduce((r,n)=>r.then(()=>C(n).then(s=>{if(s.valid===!1)return Promise.reject(s)})),Promise.resolve()).catch(r=>[r])).then(r=>{if(r===void 0||r.length===0)return f===i&&S(!0),!0;if(f===i){const{comp:n,err:s}=r[0];if(s!==void 0&&console.error(s),S(!1,n),o===!0){const q=r.find(({comp:B})=>typeof B.focus=="function"&&R(B.$)===!1);q!==void 0&&q.comp.focus()}}return!1})}function c(){i++,a.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function b(t){t!==void 0&&P(t);const o=i+1;x().then(f=>{o===i&&f===!0&&(e.onSubmit!==void 0?m("submit",t):t?.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function d(t){t!==void 0&&P(t),m("reset"),O(()=>{c(),e.autofocus===!0&&e.noResetFocus!==!0&&g()})}function g(){K(()=>{if(u.value===null)return;(u.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||u.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),o=>o.tabIndex!==-1))?.focus({preventScroll:!0})})}j(G,{bindComponent(t){a.push(t)},unbindComponent(t){const o=a.indexOf(t);o!==-1&&a.splice(o,1)}});let y=!1;return D(()=>{y=!0}),I(()=>{y===!0&&e.autofocus===!0&&g()}),M(()=>{e.autofocus===!0&&g()}),Object.assign(k.proxy,{validate:x,resetValidation:c,submit:b,reset:d,focus:g,getValidationComponents:()=>a}),()=>v("form",{class:"q-form",ref:u,onSubmit:b,onReset:d},Q(h.default))}});export{Y as Q,Z as a};
