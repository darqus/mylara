import{d as w,r as p,a as H,D as b,f as u,q as a,E as k,p as n,s as h,F as E,G as J,H as C,I as Y,x as $,J as N,K as I,L as X,O as Z,P as L,R as P,c as ee,e as x,y as d,S as K,T as D,U as te,V as ae,W as se,X as z,Y as oe,Z as le,$ as ne,u as re,a0 as ce}from"./vendor-4cnWJq__.js";import{S as ie,a as ue}from"./seo.service-DNeoGyzK.js";import{f as Q}from"./firestore.service-DVoyk11_.js";import"./index-CK2exzeq.js";import"./firebase-vendor-DF-ErlKL.js";const de={key:0},me={key:0,class:"q-my-md"},ve={key:0},fe={class:"text-h6 q-mt-md text-secondary"},A=w({__name:"DataLoader",props:{error:{type:Boolean,default:!1},isEmpty:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},emptyText:{default:"Нет доступных данных"},errorText:{default:"Произошла ошибка при загрузке данных"},loadingText:{default:""},fetchData:{type:Function,default:()=>Promise.resolve({})},dataKey:{default:""}},emits:["retry","data-loaded"],setup(l,{emit:r}){const c=l,y=r,i=p(!1),f=p(""),t=p(null),s=async()=>{i.value=!0,f.value="";try{const e=await c.fetchData();t.value=c.dataKey!==""&&typeof e=="object"&&e!==null?e[c.dataKey]:e,y("data-loaded",t.value)}catch(e){f.value=e instanceof Error?e.message:"Произошла ошибка при загрузке данных"}finally{i.value=!1}},m=()=>{s(),y("retry")};return H(()=>{s()}),(e,S)=>(u(),b(C,null,[a(J,{showing:e.loading||i.value},{default:n(()=>[h("div",null,[E(e.$slots,"loading",{},()=>[a(Y,{color:"primary",size:"40px"}),e.loadingText?(u(),b("div",de,$(e.$props.loadingText),1)):k("",!0)])])]),_:3},8,["showing"]),!(e.loading||i.value)&&(e.error||f.value)?(u(),b("div",me,[E(e.$slots,"error",{},()=>[a(Z,{class:"bg-negative text-white",rounded:""},{avatar:n(()=>[a(X,{name:"error"})]),action:n(()=>[a(I,{color:"white",label:"Попробовать снова",flat:"",onClick:m})]),default:n(()=>[N(" "+$(f.value||e.$props.errorText)+" ",1)]),_:1})])])):k("",!0),!(e.loading||i.value)&&!(e.error||f.value)?(u(),b(C,{key:1},[!e.$props.isEmpty&&(t.value||e.$slots.content)?E(e.$slots,"content",{key:0,data:t.value},()=>[t.value?(u(),b("div",ve,$(t.value),1)):k("",!0)]):E(e.$slots,"empty",{key:1},()=>[a(L,{class:"q-pa-md"},{default:n(()=>[a(X,{color:"grey-6",name:"o_info",size:"4em"}),h("div",fe,$(e.$props.emptyText),1),a(I,{class:"q-mt-md",color:"primary",label:"Обновить",outline:"",onClick:m})]),_:1})])],64)):k("",!0)],64))}}),ge=()=>{const l=P();return{isMobile:ee(()=>l.screen.lt.sm)}};function O(){const l=p(new Set),r=(t,s="/logo.svg")=>{const m=t.target,e=m.src;console.warn("Failed to load image:",e),l.value.add(e),m.src!==s&&(m.src=s,m.alt="Изображение недоступно",m.classList.add("fallback-image"))},c=t=>{const s=t.target;s.setAttribute("data-loaded","true"),s.classList.remove("fallback-image")},y=t=>l.value.has(t);return{failedImages:l,handleImageError:r,handleImageLoad:c,isImageFailed:y,getSafeImageSrc:(t,s="/logo.svg")=>y(t)?s:t,clearFailedImages:()=>{l.value.clear()}}}const pe=async()=>Q.getCollection("carousel","Не удалось загрузить данные карусели"),he={class:"carousel-wrapper relative-position"},ye=["onTouchend"],_e=["src"],be={class:"text-subtitle2"},$e={class:"text-h6"},ke=w({__name:"LandingCarousel",setup(l){const{isMobile:r}=ge(),{handleImageError:c,handleImageLoad:y}=O(),i=p(0),f=p(!1),t=p(null),s=p(null),m=p(null),e=p(),S=p(),R=({id:v,img:g,label:o,link:_,info:T})=>{t.value={id:v,img:g,label:o,link:_,info:T},f.value=!0,m.value=v},V=v=>{i.value<v.length-1&&(i.value++,M())},B=()=>{i.value>0&&(i.value--,M())},M=()=>{const v=document.querySelector(".carousel-items-container"),o=document.querySelectorAll(".carousel-card-container")[i.value];if(v&&o){const _=o.clientWidth;v.scrollTo({left:_*i.value,behavior:"smooth"})}},U=v=>{e.value=v?.touches[0]?.clientX},W=(v,g)=>{if(v.changedTouches&&v.changedTouches.length>0){S.value=v?.changedTouches[0]?.clientX;const o=e.value-S.value;Math.abs(o)>50&&(o>0?V(g):B())}};return H(()=>{s.value&&s.value.addEventListener("touchstart",U,{passive:!0})}),(v,g)=>(u(),b(C,null,[a(A,{"fetch-data":d(pe),"data-key":"items"},{content:n(({data:o})=>[h("div",he,[d(r)?k("",!0):(u(),x(I,{key:0,disable:i.value===0,class:"carousel-nav-btn carousel-prev-btn",color:"primary",icon:"chevron_left",round:"",onClick:B},null,8,["disable"])),h("div",{ref_key:"carouselRef",ref:s,class:"carousel-items-container q-py-lg q-my-sm",onTouchend:_=>W(_,Array.isArray(o)?o:[])},[(u(!0),b(C,null,K(Array.isArray(o)?o:[],({id:_,img:T,label:F,link:j,info:G})=>(u(),b("div",{key:_,class:"carousel-card-container"},[a(L,{class:z(["cursor-pointer my-card",{active:m.value===_}]),onClick:q=>R({id:_,img:T,label:F,link:j,info:G})},{default:n(()=>[h("img",{src:T,style:{height:"200px","object-fit":"cover"},onError:g[0]||(g[0]=(...q)=>d(c)&&d(c)(...q)),onLoad:g[1]||(g[1]=(...q)=>d(y)&&d(y)(...q))},null,40,_e),a(D,{class:"text-center"},{default:n(()=>[h("div",be,$(F),1)]),_:2},1024)]),_:2},1032,["class","onClick"])]))),128))],40,ye),d(r)?k("",!0):(u(),x(I,{key:1,disable:i.value===(Array.isArray(o)?o.length:0)-1,class:"carousel-nav-btn carousel-next-btn",color:"primary",icon:"chevron_right",round:"",onClick:_=>V(Array.isArray(o)?o:[])},null,8,["disable","onClick"]))])]),_:1},8,["fetch-data"]),a(se,{modelValue:f.value,"onUpdate:modelValue":g[2]||(g[2]=o=>f.value=o),onHide:g[3]||(g[3]=o=>m.value=null)},{default:n(()=>[t.value?(u(),x(L,{key:0,style:{"max-width":"350px"}},{default:n(()=>[a(D,null,{default:n(()=>[h("div",$e,$(t.value.label),1)]),_:1}),a(D,{class:"q-pt-none"},{default:n(()=>[N($(t.value.info),1)]),_:1}),a(te,{align:"right"},{default:n(()=>[ae(a(I,{color:"primary",label:"Закрыть",flat:""},null,512),[[oe]])]),_:1})]),_:1})):k("",!0)]),_:1},8,["modelValue"])],64))}}),xe=async()=>{const l=await Q.getCollection("slides","Не удалось загрузить данные слайдов");return{slides:l.items.map(c=>({...c,id:Number(c.id)})),error:l.error}},Se={class:"absolute-bottom custom-caption"},Ie={class:"text-h2"},Ce={class:"text-subtitle1"},we=w({__name:"LandingSlider",setup(l){const r=P(),c=p(1),{getSafeImageSrc:y}=O();return(i,f)=>(u(),x(A,{"fetch-data":d(xe),"data-key":"slides"},{content:n(({data:t})=>[a(le,{modelValue:c.value,"onUpdate:modelValue":f[0]||(f[0]=s=>c.value=s),class:z([{"height-xs":d(r).screen.xs,"height-sm":d(r).screen.sm,"height-md":d(r).screen.md,"height-lg":d(r).screen.lg||d(r).screen.xl},"bg-white text-white"]),"transition-next":"slide-left","transition-prev":"slide-right",animated:"",arrows:"",autoplay:"",infinite:"",swipeable:""},{default:n(()=>[(u(!0),b(C,null,K(t||[],({id:s,img:m,title:e,subtitle:S})=>(u(),x(ne,{key:s,"img-src":d(y)(m),name:s},{default:n(()=>[h("div",Se,[h("div",Ie,$(e),1),h("div",Ce,$(S),1)])]),_:2},1032,["img-src","name"]))),128))]),_:2},1032,["modelValue","class"])]),_:1},8,["fetch-data"]))}}),Te=async()=>{const l=await Q.getDocument("slogan","1","Не удалось загрузить данные слогана");return{title:l.data?.title??"",error:l.error}},qe=w({__name:"LandingSlogan",setup(l){return(r,c)=>(u(),x(A,{"fetch-data":d(Te),"is-empty":!1,"data-key":"title"},null,8,["fetch-data"]))}}),Ee={class:"q-mx-auto q-pt-xl q-px-md",style:{"max-width":"1200px"}},Be=w({__name:"HomePage",setup(l){return re(()=>ie.setMeta(ue)),(r,c)=>(u(),x(ce,null,{default:n(()=>[a(we),h("div",Ee,[a(qe)]),a(ke)]),_:1}))}});export{Be as default};
