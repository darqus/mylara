import{aQ as u,aR as n,aS as l,aT as i,aU as h,aV as b,aW as f,aX as p,aY as y,aZ as m}from"./index-Dv7iRb9i.js";function d(){const e=m();return e?e.currentUser?{isAuthenticated:!0}:{isAuthenticated:!1,error:"Пользователь не аутентифицирован"}:{isAuthenticated:!1,error:"Firebase Auth не инициализирован"}}const D={async getCollection(e,o="Не удалось загрузить данные"){const c=n();if(!c)return{items:[],error:"Firebase не инициализирован"};try{const s=await y(f(c,e)),r=[];return s.forEach(t=>{const a=t.data();r.push({id:t.id,...a})}),{items:r,error:null}}catch(s){return console.error(`Error fetching ${e} data:`,s),{items:[],error:o}}},async getDocument(e,o,c="Не удалось загрузить данные"){const s=n();if(!s)return{data:null,error:"Firebase не инициализирован"};try{const r=u(s,e,o),t=await p(r);return t.exists()?{data:t.data(),error:null}:{data:null,error:"Документ не найден"}}catch(r){return console.error(`Error fetching ${e}/${o} data:`,r),{data:null,error:c}}},async createDocument(e,o){const c=n();if(!c)return{id:null,error:"Firebase не инициализирован"};const s=d();if(!s.isAuthenticated)return{id:null,error:s.error??"Требуется аутентификация"};try{const r={...o,createdAt:i(),updatedAt:i()};return{id:(await b(f(c,e),r)).id,error:null}}catch(r){return console.error(`Error creating document in ${e}:`,r),r&&typeof r=="object"&&"code"in r&&r.code==="permission-denied"?{id:null,error:"Недостаточно прав для создания документа"}:{id:null,error:"Не удалось создать документ"}}},async updateDocument(e,o,c){const s=n();if(!s)return{success:!1,error:"Firebase не инициализирован"};const r=d();if(!r.isAuthenticated)return{success:!1,error:r.error??"Требуется аутентификация"};try{const t=u(s,e,o),a={...c,updatedAt:i()};return await h(t,a),{success:!0,error:null}}catch(t){return console.error(`Error updating document ${o} in ${e}:`,t),t&&typeof t=="object"&&"code"in t&&t.code==="permission-denied"?{success:!1,error:"Недостаточно прав для обновления документа"}:{success:!1,error:"Не удалось обновить документ"}}},async deleteDocument(e,o){const c=n();if(!c)return{success:!1,error:"Firebase не инициализирован"};const s=d();if(!s.isAuthenticated)return{success:!1,error:s.error??"Требуется аутентификация"};try{const r=u(c,e,o);return await l(r),{success:!0,error:null}}catch(r){return console.error(`Error deleting document ${o} from ${e}:`,r),r&&typeof r=="object"&&"code"in r&&r.code==="permission-denied"?{success:!1,error:"Недостаточно прав для удаления документа"}:{success:!1,error:"Не удалось удалить документ"}}}};export{D as f};
