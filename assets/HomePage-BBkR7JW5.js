import{d as q,r as y,a as P,y as b,f as s,s as a,K as k,p as r,q as c,L,O as Y,F as T,R as Z,v as x,S as G,T as w,B as E,U as J,C as A,V as O,c as ee,e as $,x as g,z as R,W as M,D as Q,X as te,A as ae,Y as se,Z as oe,$ as le,a0 as ne,a1 as re,a2 as ie,t as ce,u as ue,a3 as de}from"./vendor-CqOrBQm9.js";import{S as me,a as ge}from"./seo-constants-BlY3PbiY.js";import{firestoreService as V}from"./firestore.service-tyif0auk.js";import"./index-pboCOTYc.js";import"./firebase-vendor-Dt--ACjN.js";const ve={key:0},pe={key:0,class:"q-my-md"},fe={key:0},he={class:"text-h6 q-mt-md text-secondary"},B=q({__name:"DataLoader",props:{error:{type:Boolean,default:!1},isEmpty:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},emptyText:{default:"Нет доступных данных"},errorText:{default:"Произошла ошибка при загрузке данных"},loadingText:{default:""},fetchData:{type:Function,default:()=>Promise.resolve({})},dataKey:{default:""}},emits:["retry","data-loaded"],setup(o,{emit:u}){const d=o,i=u,m=y(!1),f=y(""),t=y(null),l=async()=>{m.value=!0,f.value="";try{const e=await d.fetchData();t.value=d.dataKey!==""&&typeof e=="object"&&e!==null?e[d.dataKey]:e,i("data-loaded",t.value)}catch(e){f.value=e instanceof Error?e.message:"Произошла ошибка при загрузке данных"}finally{m.value=!1}},v=()=>{l(),i("retry")};return P(()=>{l()}),(e,S)=>(s(),b(T,null,[a(Y,{showing:e.loading||m.value},{default:r(()=>[c("div",null,[L(e.$slots,"loading",{},()=>[a(Z,{color:"primary",size:"40px"}),e.loadingText?(s(),b("div",ve,x(e.$props.loadingText),1)):k("",!0)])])]),_:3},8,["showing"]),!(e.loading||m.value)&&(e.error||f.value)?(s(),b("div",pe,[L(e.$slots,"error",{},()=>[a(J,{class:"bg-negative text-white",rounded:""},{avatar:r(()=>[a(E,{name:"error"})]),action:r(()=>[a(w,{color:"white",label:"Попробовать снова",flat:"",onClick:v})]),default:r(()=>[G(" "+x(f.value||e.$props.errorText)+" ",1)]),_:1})])])):k("",!0),!(e.loading||m.value)&&!(e.error||f.value)?(s(),b(T,{key:1},[!e.$props.isEmpty&&(t.value||e.$slots.content)?L(e.$slots,"content",{key:0,data:t.value},()=>[t.value?(s(),b("div",fe,x(t.value),1)):k("",!0)]):L(e.$slots,"empty",{key:1},()=>[a(A,{class:"q-pa-md"},{default:r(()=>[a(E,{color:"grey-6",name:"o_info",size:"4em"}),c("div",he,x(e.$props.emptyText),1),a(w,{class:"q-mt-md",color:"primary",label:"Обновить",outline:"",onClick:v})]),_:1})])],64)):k("",!0)],64))}}),ye=()=>{const o=O();return{isMobile:ee(()=>o.screen.lt.sm)}};function U(){const o=y(new Set),u=(t,l="/logo.svg")=>{const v=t.target,e=v.src;console.warn("Failed to load image:",e),o.value.add(e),v.src!==l&&(v.src=l,v.alt="Изображение недоступно",v.classList.add("fallback-image"))},d=t=>{const l=t.target;l.setAttribute("data-loaded","true"),l.classList.remove("fallback-image")},i=t=>o.value.has(t);return{failedImages:o,handleImageError:u,handleImageLoad:d,isImageFailed:i,getSafeImageSrc:(t,l="/logo.svg")=>i(t)?l:t,clearFailedImages:()=>{o.value.clear()}}}const _e=async()=>V.getCollection("carousel","Не удалось загрузить данные карусели"),be={class:"landing-carousel carousel-wrapper relative-position"},xe=["onTouchend"],ke=["src"],$e={class:"text-label text-subtitle2 q-mb-sm"},we={class:"btn-more"},Se={class:"text-body1"},Ce=["innerHTML"],Ie={class:"text-caption text-grey-6"},Te=q({__name:"LandingCarousel",setup(o){const{isMobile:u}=ye(),{handleImageError:d,handleImageLoad:i}=U(),m=y(0),f=y(!1),t=y(null),l=y(null),v=y(null),e=y(),S=y(),F=({id:p,img:h,label:n,link:_,info:C})=>{t.value={id:p,img:h,label:n,link:_,info:C},f.value=!0,v.value=p},z=p=>{m.value<p.length-1&&(m.value++,X())},H=()=>{m.value>0&&(m.value--,X())},X=()=>{const p=document.querySelector(".carousel-items-container"),n=document.querySelectorAll(".carousel-card-container")[m.value];if(p&&n){const _=n.clientWidth;p.scrollTo({left:_*m.value,behavior:"smooth"})}},W=p=>{e.value=p?.touches[0]?.clientX},j=(p,h)=>{if(p.changedTouches&&p.changedTouches.length>0){S.value=p?.changedTouches[0]?.clientX;const n=e.value-S.value;Math.abs(n)>50&&(n>0?z(h):H())}};return P(()=>{l.value&&l.value.addEventListener("touchstart",W,{passive:!0})}),(p,h)=>(s(),b(T,null,[a(B,{"fetch-data":g(_e),"data-key":"items"},{content:r(({data:n})=>[c("div",be,[g(u)?k("",!0):(s(),$(w,{key:0,disable:m.value===0,class:"carousel-nav-btn carousel-prev-btn",color:"primary",icon:"chevron_left",round:"",onClick:H},null,8,["disable"])),c("div",{ref_key:"carouselRef",ref:l,class:"carousel-items-container q-py-lg q-my-sm",onTouchend:_=>j(_,Array.isArray(n)?n:[])},[(s(!0),b(T,null,R(Array.isArray(n)?n:[],({id:_,img:C,label:D,link:N,info:K})=>(s(),b("div",{key:_,class:"carousel-card-container"},[a(A,{class:M([[{active:v.value===_}],"cursor-pointer my-card carousel-item-card"]),onClick:I=>F({id:_,img:C,label:D,link:N,info:K})},{default:r(()=>[c("img",{src:C,style:{width:"100%","aspect-ratio":"3/4","object-fit":"cover"},onError:h[0]||(h[0]=(...I)=>g(d)&&g(d)(...I)),onLoad:h[1]||(h[1]=(...I)=>g(i)&&g(i)(...I))},null,40,ke),a(Q,{class:"description-wrapper text-center q-pb-sm"},{default:r(()=>[c("div",$e,x(D),1),c("div",we,[a(w,{class:"more-details-btn",color:"primary","icon-right":"arrow_forward",label:"Подробнее",size:"sm","no-caps":"",outline:"",onClick:te(I=>F({id:_,img:C,label:D,link:N,info:K}),["stop"])},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["class","onClick"])]))),128))],40,xe),g(u)?k("",!0):(s(),$(w,{key:1,disable:m.value===(Array.isArray(n)?n.length:0)-1,class:"carousel-nav-btn carousel-next-btn",color:"primary",icon:"chevron_right",round:"",onClick:_=>z(Array.isArray(n)?n:[])},null,8,["disable","onClick"]))])]),_:1},8,["fetch-data"]),a(le,{modelValue:f.value,"onUpdate:modelValue":h[2]||(h[2]=n=>f.value=n),onHide:h[3]||(h[3]=n=>v.value=null)},{default:r(()=>[t.value?(s(),$(A,{key:0,class:"dialog-standard"},{default:r(()=>[t.value.label?(s(),$(Q,{key:0},{default:r(()=>[c("div",Se,x(t.value.label),1)]),_:1})):k("",!0),t.value.info?(s(),$(Q,{key:1,class:"q-pt-none"},{default:r(()=>[c("div",{class:"text-body2 text-grey-7",innerHTML:t.value.info},null,8,Ce),a(ae,{class:"q-my-md"}),c("div",Ie," ID элемента: "+x(t.value.id),1)]),_:1})):k("",!0),a(se,{align:"between"},{default:r(()=>[t.value.link?(s(),$(w,{key:0,href:t.value.link,color:"primary",icon:"open_in_new",label:"Перейти",target:"_blank",dense:"","no-caps":"",outline:""},null,8,["href"])):k("",!0),oe(a(w,{color:"red-6","icon-right":"close",dense:"","no-caps":"",outline:""},null,512),[[ne]])]),_:1})]),_:1})):k("",!0)]),_:1},8,["modelValue"])],64))}}),qe=async()=>{const o=await V.getCollection("slides","Не удалось загрузить данные слайдов");return{slides:o.items.map(d=>({...d,id:Number(d.id)})),error:o.error}},Le={class:"absolute-bottom custom-caption"},De={class:"text-h2"},Qe={class:"text-subtitle1"},Ee=q({__name:"LandingSlider",setup(o){const u=O(),d=y(1),{getSafeImageSrc:i}=U();return(m,f)=>(s(),$(B,{"fetch-data":g(qe),"data-key":"slides"},{content:r(({data:t})=>[a(ie,{modelValue:d.value,"onUpdate:modelValue":f[0]||(f[0]=l=>d.value=l),class:M([{"height-xs":g(u).screen.xs,"height-sm":g(u).screen.sm,"height-md":g(u).screen.md,"height-lg":g(u).screen.lg||g(u).screen.xl},"landing-slider bg-white text-white"]),"transition-next":"slide-left","transition-prev":"slide-right",animated:"",arrows:"",autoplay:"",infinite:"",swipeable:""},{default:r(()=>[(s(!0),b(T,null,R(t||[],({id:l,img:v,title:e,subtitle:S})=>(s(),$(re,{key:l,"img-src":g(i)(v),name:l},{default:r(()=>[c("div",Le,[c("div",De,x(e),1),c("div",Qe,x(S),1)])]),_:2},1032,["img-src","name"]))),128))]),_:2},1032,["modelValue","class"])]),_:1},8,["fetch-data"]))}}),Ae=async()=>{const o=await V.getDocument("slogan","1","Не удалось загрузить данные слогана");return{title:o.data?.title??"",image:o.data?.image??"",layout:o.data?.layout??"text-left",error:o.error}},Me={class:"absolute-full flex flex-center bg-grey-2"},Ve={class:"text-h4 slogan-text"},Be={key:1,class:"text-center"},Fe={class:"text-h4 q-mb-md"},ze=q({__name:"LandingSlogan",setup(o){return(u,d)=>(s(),$(B,{"fetch-data":g(Ae),"is-empty":!1},{content:r(({data:i})=>[i?.image?(s(),b("div",{key:0,class:M([{"text-wrap-right":i?.layout==="text-right","text-wrap-left":i?.layout==="text-left"},"landing-slogan"])},[a(ce,{src:i.image,alt:"Изображение слогана",class:"slogan-image"},{error:r(()=>[c("div",Me,[a(E,{color:"grey-5",name:"image",size:"60px"})])]),_:2},1032,["src"]),c("div",Ve,x(i?.title||""),1)],2)):(s(),b("div",Be,[c("div",Fe,x(i?.title||""),1)]))]),_:1},8,["fetch-data"]))}}),He={class:"q-mx-auto q-pt-xl q-px-md",style:{"max-width":"1200px"}},Re=q({__name:"HomePage",setup(o){return ue(()=>me.setMeta(ge)),(u,d)=>(s(),$(de,null,{default:r(()=>[a(Ee),c("div",He,[a(ze)]),a(Te)]),_:1}))}});export{Re as default};
