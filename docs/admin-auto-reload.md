# Автоматическая загрузка данных при переключении коллекций в админ-панели

## Обзор изменений

В админ-панели была реализована автоматическая подгрузка данных при переключении между страницами управления различными сущностями (коллекциями).

## Реализованные улучшения

### 1. AdminCollectionPage.vue

**Добавлена автоматическая перезагрузка данных:**

- При переключении между коллекциями (например, с "Продукты" на "Слайды") данные автоматически загружаются
- Состояние таблицы сбрасывается при смене коллекции
- Фильтры и пагинация сбрасываются к начальным значениям
- Показывается индикатор загрузки во время перехода

**Ключевые изменения:**

```typescript
// Отслеживание изменений параметра коллекции в URL
watch(
  () => collectionName.value,
  (newCollection, oldCollection) => {
    if (newCollection !== oldCollection && newCollection) {
      resetTableState()
      void loadData()
    }
  },
)

// Функция сброса состояния
function resetTableState() {
  tableState.value = {
    items: [],
    loading: true, // Показываем загрузку
    pagination: { page: 1, rowsPerPage: 10, rowsNumber: 0 },
    filter: '',
    selected: [],
  }
  // Закрытие всех открытых диалогов
  showCreateDialog.value = false
  showDeleteDialog.value = false
  editingItem.value = null
  itemToDelete.value = null
}
```

### 2. AdminMenuItem.vue

**Добавлено отображение активного пункта меню:**

- Текущая коллекция выделяется в меню навигации
- Активный элемент получает визуальное отличие (цвет и фон)

**Ключевые изменения:**

```typescript
// Определение активного состояния пункта меню
const isActive = computed(() => {
  if (props.link === '/' && route.path === '/') return true
  if (props.link.includes('/admin/collection/')) {
    return route.path === props.link
  }
  return route.path.startsWith(props.link) && props.link !== '/'
})
```

### 3. Уведомления пользователя

**Добавлены информационные уведомления:**

- При переключении между коллекциями показывается краткое уведомление
- Уведомление исчезает автоматически через 1 секунду

## Доступные коллекции

В системе настроены следующие коллекции для управления:

1. **Продукты (carousel)** - `/admin/collection/carousel`
   - Управление каруселью продуктов на главной странице
   - Поля: изображение, информация, название, ссылка

2. **Слайды (slides)** - `/admin/collection/slides`
   - Управление слайдами баннера
   - Поля: изображение, заголовок, подзаголовок

3. **Слоган (slogan)** - `/admin/collection/slogan`
   - Управление текстом слогана
   - Поля: текст слогана

## Пользовательский опыт

### Раньше:

- При переключении между коллекциями данные не загружались автоматически
- Требовалось вручную обновлять страницу
- Отсутствовало визуальное отображение текущей коллекции в меню

### Теперь:

- Мгновенное переключение между коллекциями с автоматической загрузкой данных
- Визуальная индикация загрузки во время переходов
- Четкое отображение активной коллекции в меню навигации
- Информационные уведомления о переключениях
- Сброс состояния фильтров и выбранных элементов при смене коллекции

## Техническая реализация

### Используемые технологии:

- Vue 3 Composition API
- Vue Router для отслеживания изменений маршрута
- Quasar Framework для UI компонентов
- Reactive watchers для отслеживания изменений
- TypeScript для типизации

### Паттерны проектирования:

- Composable pattern для переиспользуемой логики
- Reactive state management
- Automatic cleanup при смене компонентов
- Separation of concerns между UI и бизнес-логикой

## Преимущества реализации

1. **Улучшенный UX** - пользователям не нужно вручную обновлять данные
2. **Производительность** - данные загружаются только при необходимости
3. **Надежность** - состояние всегда корректно сбрасывается при переходах
4. **Визуальная обратная связь** - пользователь всегда знает, где находится
5. **Масштабируемость** - легко добавлять новые коллекции
